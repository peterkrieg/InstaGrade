function gradeColor(e){return e<20?"hsl("+(350+Math.round(e/2))+", 100%, 41%)":e<40?"hsl("+Math.round((e-20)/2)+", 100%, 41%)":e<60?"hsl("+Math.round((e-28)/2)+", 85%, 57%)":e<70?"hsl("+Math.round(2*(e-51))+", 88%, 58%)":e<80?"hsl("+Math.round(2*(e-50))+", 85%, 58%)":e<90?"hsl("+Math.round(2*(e-40))+", 60%, 66%)":e<=100?"hsl("+Math.round(240-e)+", 100%, 35%)":void 0}function analyzeFunc(e){this.analyzeData=function(t,o){var r=t.user;t=function(){for(var o=t.media,r=0,n=0,a=0,i=0,s={},l=[],u=[],c=[],d=[],p={Monday:0,Tuesday:0,Wednesday:0,Thursday:0,Friday:0,Saturday:0,Sunday:0},m=0;m<o.length;m++){var f=o[m];if("image"===f.type?a++:"video"===f.type&&i++,r+=f.likes.count,!0===f.user_has_liked&&n++,f.location){var h=f.location,g={name:h.name,latitude:h.latitude,longitude:h.longitude,date:f.created_time,pic:f.images.low_resolution,instagramId:h.id};l.push(g)}if(f.tags.length>0)for(var v=0;v<f.tags.length;v++){var y=f.tags[v];s.hasOwnProperty(y)?s[y]++:s[y]=1}if(f.tags.length>0){var k=[];k.push(f.tags.length),k.push(f.comments.count+f.likes.count),k.tagNames=f.tags,u.push(k)}var w=1e3*f.created_time;c.push(w),p[e("date")(w,"EEEE")]++}for(var b in t.analytics.numLikesReceived=r,t.analytics.numPics=a,t.analytics.numVids=i,t.analytics.averageNumLikes=r/t.user.numMedia,t.analytics.numSelfLikes=n,t.analytics.allTags=s,t.analytics.hashtagScatter=u,t.analytics.allTimes=c,t.analytics.daysOfWeek=p,p)d.push(p[b]);return t.analytics.daysOfWeekArr=d,l.sort(function(e,t){return e.date-t.date}),t.map.allLocations=l,t}(),t=function(){for(var e={},o=t.relationships.likesReceived,r=0;r<o.length;r++)for(var n=o[r],a=0;a<n.length;a++){var i=n[a],s=i.full_name||i.username,l=i.username,u=i.profile_picture,c=i.id;e.hasOwnProperty(c)?e[c].count++:(e[c]={count:1},e[c].name=s,e[c].username=l,e[c].pic=u)}return t.relationships.userLikersArr=function(){var t=[];for(var o in e){var r=o,n=e[r],a=n.count,i=n.username,s={id:r,name:n.name,username:i,count:a,pic:n.pic};t.push(s)}return t.sort(function(e,t){return e.count-t.count}),t}(),t.relationships.userLikers=e,t}(),t=function(){for(var e=t.relationships.likesGiven,o={},r=0;r<e.length;r++){var n=e[r].user,a=n.id;if(o.hasOwnProperty(a))o[a].count++;else{var i=n.full_name||n.username,s=n.username,l=n.profile_picture;o[a]={count:1,name:i,username:s,pic:l}}}return t.relationships.yourLikesUsers=o,t.relationships.yourLikesUsersArr=function(){var e=[];for(var t in o){var r=t,n=o[t];n.id=r,e.push(n)}return e.sort(function(e,t){return e.count-t.count}),e}(),t}(),t=function(){var e=t.relationships.userLikers;for(var o in e)e[o].likesReceived=e[o].count,delete e[o].count;var r=t.relationships.yourLikesUsers;for(var o in r)e[o]?e[o].likesGiven=r[o].count:(e[o]={},e[o].pic=r[o].pic,e[o].name=r[o].name,e[o].likesGiven=r[o].count);for(var o in e){var n=e[o];n.hasOwnProperty("likesReceived")||(n.likesReceived=0),n.hasOwnProperty("likesGiven")||(n.likesGiven=0),e[o]=n}var a=[];for(var o in e)e[o].instagramId=o,a.push(e[o]);a.sort(function(e,t){return e.likesGiven+e.likesReceived-(t.likesGiven+t.likesReceived)});for(var i=a[0],s=a[0],l=0;l<a.length;l++){var u=a[l];u.likesReceived>=i.likesReceived&&(i=u),u.likesGiven>=s.likesGiven&&(s=u)}return i.mostLikesReceived=!0,i.numMedia=t.user.numMedia,s.mostLikesGiven=!0,t.relationships.likesComparison=e,t.relationships.likesComparisonArr=a,t}(),t=function(){for(var e=[],o=[],r=t.relationships.follows,n=t.relationships.followers,a=0;a<r.length;a++)for(var i=r[a],s=0;s<n.length;s++){var l=n[s];if(i.id===l.id)break;s===n.length-1&&o.push(r[a])}for(var u=0;u<n.length;u++)for(var c=n[u],d=0;d<r.length;d++){var p=r[d];if(c.id===p.id)break;d===r.length-1&&e.push(n[u])}return t.relationships.uniqueFollowers=e,t.relationships.uniqueFollows=o,t}(),t=function(){var e=r.numFollowers,o=r.numFollows,n=t.analytics.averageNumLikes;t.grade.averageNumLikes=n;var a=e/o;t.grade.userRatio=a;var i=t.relationships.likesGiven.length,s=t.analytics.numLikesReceived;t.analytics.numLikesGiven=i,t.grade.numLikesGiven=i,t.analytics.numLikesReceived=s,t.grade.numLikesReceived=s;var l=s/i;t.grade.likesRatio=l;var u=t.analytics.numSelfLikes/t.user.numMedia;t.grade.selfLikesRatio=u,t.grade.numSelfLikes=t.analytics.numSelfLikes;var c=n/(e/100);t.grade.adjustedAverageNumLikes=c;var d=t.analytics.allTags,p=[];for(var m in d)p.push({hashtag:m,count:d[m]});p.sort(function(e,t){return t.count-e.count}),t.analytics.allTagsArr=p;var f={};return s<=625&&(f.numLikesReceived=2*Math.pow(s,.5)),s>625&&s<=2500&&(f.numLikesReceived=20+1.2*Math.pow(s,.5)),s>2500&&s<=9e3&&(f.numLikesReceived=57.15+1*Math.pow(s,.4)),s>9e3&&s<=5e4&&(f.numLikesReceived=95.317777+1e-4*(s-9e3)),s>5e4&&(f.numLikesReceived=100),l<=.5&&(f.likesRatio=100*Math.pow(l,.7)),l>.5&&l<=3&&(f.likesRatio=21+50*Math.pow(l,.3)),l>3&&l<=18&&(f.likesRatio=90.5194585+.6*(l-3)),l>18&&(f.likesRatio=100),n<=9&&(f.averageNumLikes=20*Math.pow(n,.5)),n>9&&n<=30&&(f.averageNumLikes=16.85+20*Math.pow(n,.35)),n>30&&n<=80&&(f.averageNumLikes=35.85+20*Math.pow(n,.25)),n>80&&n<=270&&(f.averageNumLikes=95.66395124+.02*(n-80)),n>270&&(f.averageNumLikes=100),c<=8&&(f.adjustedAverageNumLikes=30*Math.pow(c,.5)),c>8&&c<=15&&(f.adjustedAverageNumLikes=28.86+30*Math.pow(c,.3)),c>15&&c<=24&&(f.adjustedAverageNumLikes=51.45+30*Math.pow(c,.15)),c>24&&(f.adjustedAverageNumLikes=100),a<=.4&&(f.userRatio=90*Math.pow(a,.5)),a>.4&&a<=1.8&&(f.userRatio=75*Math.pow(a,.3)),a>1.8&&a<=7&&(f.userRatio=89.462908875+2*(a-1.8)),a>7&&(f.userRatio=100),u<1&&(f.selfLikesRatio=50-400*Math.pow(u-.5,3)),u>=1&&(f.selfLikesRatio=0),f.overallScore=(10*f.numLikesReceived+15*f.likesRatio+15*f.averageNumLikes+40*f.adjustedAverageNumLikes+25*f.userRatio+10*f.selfLikesRatio)/115,console.log("overall score is: \n\n",f.overallScore),t.grade.scores=f,t}(),o.resolve(t)}}function demoServiceFunc(e){this.test=function(){console.log("test")},this.getLastDemoReport=function(){return e.get("/api/reports/demoReport?id=56d90e0de3589eba72597430").then(function(e){return e.data})},this.getStatsDemo=function(){return console.log("get stats demo service"),e.get("/api/demo/stats").then(function(e){return console.log(e.data),e.data})},this.getSpecificReport=function(t){return e.get("/api/reports/demoReport?id="+t).then(function(e){return e.data})}}function followFunc(e,t){this.unfollowUser=function(t,o){var r="/api/insta/relationships?action=unfollow&token="+o+"&id="+t;return e.post(r).then(function(e){console.log(e)})},this.followUser=function(e){console.log("inside of service, id is",e)}}function instaFunc(e,t,o){var r=500,n=500,a=1500,i=1400;function s(t,o,n){var a=[],s=0;!function u(c){e({method:"JSONP",url:c}).then(function(c){s++;for(var d=c.data,p=c.data.data,m=0;m<p.length;m++)a.push(p[m]);var f=d.pagination.next_url;s!==i&&f?u(f+"&callback=JSON_CALLBACK"):(o.relationships.likesGiven=a,function(t,o,n){var a=[],i=0;!function s(u){e({method:"JSONP",url:u}).then(function(e){i++;for(var u=e.data,c=0;c<u.data.length;c++)a.push(u.data[c]);var d=u.pagination.next_url;d?s(d+"&callback=JSON_CALLBACK"):(!d||i>=r)&&(o.relationships.follows=a,l(t,o,n))})}("https://api.instagram.com/v1/users/self/follows?access_token="+t+"&callback=JSON_CALLBACK")}(t,o,n))})}("https://api.instagram.com/v1/users/self/media/liked?access_token="+t+"&callback=JSON_CALLBACK")}function l(t,o,r){var a;l("https://api.instagram.com/v1/users/self/followed-by?access_token="+t+"&callback=JSON_CALLBACK");var i=[],s=0;function l(t){e({method:"JSONP",url:t}).then(function(e){s++;var t=e.data;for(var a=0;a<t.data.length;a++){i.push(t.data[a])}var c=t.pagination.next_url;if(c){l(c+"&callback=JSON_CALLBACK")}else if(!c||s>=n){o.relationships.followers=i;u(o,r)}})}}function u(e,t){o.analyzeData(e,t)}this.getMedia=function(o,r){var n=t.defer(),a={user:r,media:[],relationships:{},grade:{},analytics:{},map:{}};return function t(o){e({method:"JSONP",url:o}).then(function(e){for(var o=e.data,r=o.data,i=o.pagination.next_url,s=0;s<r.length;s++)a.media.push(r[s]);o.pagination.next_url?t(i+"&callback=JSON_CALLBACK"):n.resolve(a)},function(e){console.log("ERROR",e)});return n.promise}("https://api.instagram.com/v1/users/self/media/recent?access_token="+o+"&callback=JSON_CALLBACK")},this.getOtherData=function(o,r){var n=t.defer();return function(t,o,r){var n,i=o.media,l=0,u=[];n=i.length<=a?i.length:a;for(var c=0;c<n;c++){var d=i[c].id;e({method:"JSONP",url:"https://api.instagram.com/v1/media/"+d+"/likes?access_token="+t+"&callback=JSON_CALLBACK"}).then(function(e){var a=e.data.data;i[l].likesFull=a,o.media=i,u.push(a),l++,u.length===n&&(o.relationships.likesReceived=u,s(t,o,r))})}}(o,r,n),n.promise}}function userFunc(e,t){this.addUser=function(t){return e.post("/api/users",t).then(function(e){return e})},this.getAccount=function(t){return e.get("/api/users/account").then(function(e){return e.data})},this.toggleReadyForReport=function(t){return e.put("/api/users/readyForReport",{status:t}).then(function(e){return e})},this.toggleSpecificReport=function(t){return e.put("/api/users/specificReport",{status:t}).then(function(e){return e})},this.checkIfLoggedIn=function(){return e.get("/api/users/checkIfLoggedIn").then(function(e){return e.data})},this.deleteUser=function(t){e.post("/api/users/deleteUser?userId="+t)}}function profileFunc(e,t,o,r,n,a,i){window.scroll(0,0),console.log(t),e.user=t,e.errorNotDay=!1,e.loadingStats=!0,e.toggleError=function(t){e.errorNotDay=t,!1===t&&a.cancel(e.timer)},e.newReport=function(){console.log("\n\n new report!! \n\n");var t=(new Date).getTime();o.getLatestReportDate().then(function(o){if(t-o<864e5){console.log("hasnt been day yet!!");var i=864e5-(t-o);e.timeLeft=i,e.timer=a(function(){e.timeLeft-=1e3,e.timeLeft<=0&&(e.errorNotDay=!1)},1e3),e.toggleError(!0)}else r.toggleReadyForReport(!0).then(function(e){n.go("report.media")})})},e.loadSpecificReport=function(e){console.log("load specific report fired!!"),console.log(e),r.toggleSpecificReport(e).then(function(e){n.go("report.media")})},o.getStats().then(function(r){console.log(r),console.log("blahblah \n\n\n\n"),e.stats=r,e.statsReversed=r.slice(0),e.statsReversed.reverse(),e.loadingStats=!1,e.selectedItem="numLikesGiven",console.log(t),o.getRelationships(t._id).then(function(t){console.log(t);var o,r=[],n=t.relationshipsStats;e.report=t.lastReport;for(var a=0;a<n.length;a++)for(var i=n[a].followers,s=0;s<i.length;s++){var l=i[s];e:for(var u=a+1;u<n.length;u++)for(var c=n[u].followers,d=0;d<c.length;d++){var p=c[d];if(l.id===p.id)break;if(d===c.length-1){var m={date1:n[u-1].date,date2:n[u].date,user:l};if(0===r.length){r.push(m);break e}for(var f=0;f<r.length;f++){var h=r[f];if(l.id===h.user.id)break e;if(f===r.length-1){r.push(m);break e}}break e}}}console.log(r),e.unfollows=r,o={uniqueFollows:0,uniqueFollowers:0},e.noMore={uniqueFollows:!1,uniqueFollowers:!1},e.uniqueFollows=[],e.uniqueFollowers=[],e.loadMore=function(t){o[t]++;for(var r=o[t],n=0;n<12*r;n++){var a=e.clone[t].pop();if(!a)return void(e.noMore[t]=!0);e[t].push(a)}},e.clone={uniqueFollows:e.report.relationships.uniqueFollows.slice(0),uniqueFollowers:e.report.relationships.uniqueFollowers.slice(0)},e.loadMore("uniqueFollows"),e.loadMore("uniqueFollowers")})}),e.deleteUser=function(){r.deleteUser(t._id),window.location.assign("http://mediascore.rocks")}}function basicCtrlFunc(e,t){window.scroll(0,0),t.checkIfLoggedIn().then(function(t){console.log(t),t.name?(e.user=t,e.full=!0):e.demo=!0}),e.email="pkrieg2@gmail.com"}function profileFuncDemo(e,t,o,r,n,a,i){window.scroll(0,0),e.errorNotDay=!1,e.loadingStats=!0,e.user={name:"Demo User",profilePicture:"../demo/profilesmall.jpg"},e.loadingUser=!1,e.toggleError=function(t){e.errorNotDay=t,!1===t&&a.cancel(e.timer)},e.newReport=function(){alert("Sorry, You Can't do That In Demo Mode!")},e.loadSpecificReport=function(e){n.go("demoReport.media",{reportId:e})},t.getStatsDemo().then(function(o){e.stats=o,e.statsReversed=o.slice(0),e.statsReversed.reverse(),e.loadingStats=!1,e.selectedItem="numLikesGiven",e.unfollows=[{date1:"2015-12-29T18:05:04.352Z",date2:"2015-12-30T23:05:55.168Z",user:{full_name:"Alexandra Smith",id:12345678,profile_picture:"http://api.randomuser.me/portraits/med/women/39.jpg",username:"demoaccount"}},{date1:"2015-12-24T15:05:03.345Z",date2:"2015-12-27T18:05:03.345Z",user:{full_name:"Jack Unfollower!",id:12345,profile_picture:"http://api.randomuser.me/portraits/med/men/20.jpg",username:"demo account"}},{date1:"2016-01-15T08:27:50.635Z",date2:"2016-01-17T10:30:50.635Z",user:{full_name:"Samantha Something",id:22,profile_picture:"http://api.randomuser.me/portraits/med/women/50.jpg",username:"demo account"}}],t.getLastDemoReport().then(function(t){var o;e.report=t,o={uniqueFollows:0,uniqueFollowers:0},e.noMore={uniqueFollows:!1,uniqueFollowers:!1},e.uniqueFollows=[],e.uniqueFollowers=[],e.loadMore=function(t){o[t]++;for(var r=o[t],n=0;n<12*r;n++){var a=e.clone[t].pop();if(!a)return void(e.noMore[t]=!0);e[t].push(a)}},e.clone={uniqueFollows:e.report.relationships.uniqueFollows.slice(0),uniqueFollowers:e.report.relationships.uniqueFollowers.slice(0)},e.loadMore("uniqueFollows"),e.loadMore("uniqueFollowers")})}),e.deleteUser=function(){alert("Sorry, You Can't do That in Demo Mode!")}}function demoReportCtrlFunc(e,t,o,r,n,a,i,s,l,u){function c(t){e.media=t.media,e.user.numMedia=t.media.length,function(e){for(var t=0;t<e.length;t++){var o=e[t];"video"===o.type&&(o.safeurl=i.trustAsResourceUrl(o.videos.standard_resolution.url))}}(e.media),function(t){e.clone={uniqueFollows:e.report.relationships.uniqueFollows.slice(0),uniqueFollowers:e.report.relationships.uniqueFollowers.slice(0),likesComparisonArr:e.report.relationships.likesComparisonArr.slice(0)};for(var o=e.report.relationships.likesComparisonArr,r=0;r<o.length;r++){var n=o[r];if(n.mostLikesReceived){e.mostLikesReceived=n,console.log(e.mostLikesReceived);break}}for(var a=e.report.analytics.allTagsArr,i=[],l=[],u=-1,r=0;r<a.length&&a[r];r++){var c=a[r].hashtag,d=a[r].count;r%12==0?(u++,i.push([c]),l.push([d])):(i[u].push(c),l[u].push(d))}e.noMoreLeft=!0,e.noMoreRight=!1,e.index=0;var p=i[0],m=l[0];e.report.analytics.currentTags=p,e.report.analytics.currentTagsCounts=m,e.report.analytics.tagsGroupsNames=i,e.report.analytics.tagsGroupsCounts=l;var f=s("number")(100*t.grade.selfLikesRatio,1),h=t.grade.selfLikesRatio;0===h&&(e.likesRatioMessage="Wow, you haven't liked a single one of your photos!  Thank you for ");h<.2?e.likesRatioMessage="Congrats, you must not be very self-centered!  You have only liked "+t.grade.numSelfLikes+" ("+f+"%) of your media.  ":h<.5&&(e.likesRatioMessage="Okay, you've liked "+t.grade.numSelfLikes+" ("+f+"%) of your media.  Not too high, but try to be a little ");e.scores=t.grade.scores,console.log("scores is \n\n"),console.log(e.scores);var g=function(e){if((e=Math.round(e))<60)return"F";if(e>99)return"A+";var t,o=Number(e.toString()[0]),r=[6,7,8,9].indexOf(o);e%10<10&&(t="+");e%10<7&&(t="");e%10<3&&(t="-");return["D","C","B","A"][r]+t}(e.scores.overallScore);e.scores.overallScoreLetter=g,e.loadMore("uniqueFollows"),e.loadMore("uniqueFollowers"),e.loadMore("likesComparisonArr"),e.loadingEverythingElse=!1,e.loading=!1,e.loadingMedia=!1}(t)}window.scroll(0,0),console.log("demo report ctrl func"),e.user={name:"Demo User",profilePicture:"../demo/profilesmall.jpg"},e.loadingUser=!1,e.loading=!0,e.loadingMedia=!0,e.loadingEverythingElse=!0,console.log(u),u.reportId?t.getSpecificReport(u.reportId).then(function(t){e.report=t,c(t)}):t.getLastDemoReport().then(function(t){e.report=t,c(t)}),e.closeExample=function(){$("div.example").slideToggle(400)};var d={uniqueFollows:0,uniqueFollowers:0,userLikersArr:0,yourLikesUsersArr:0,likesComparisonArr:0};e.noMore={uniqueFollows:!1,uniqueFollowers:!1,userLikersArr:!1,yourLikesUsersArr:!1,likesComparisonArr:!1},e.uniqueFollows=[],e.uniqueFollowers=[],e.userLikersArr=[],e.yourLikesUsersArr=[],e.likesComparisonArr=[],e.loadMore=function(t){d[t]++;for(var o=d[t],r=0;r<12*o;r++){var n=e.clone[t].pop();if(!n)return void(e.noMore[t]=!0);e[t].push(n)}}}function ctrlFunc(e,t,o,r){window.scroll(0,0)}angular.module("myApp",["ui.router"]).config(["$urlRouterProvider","$stateProvider",function(e,t){t.state("home",{url:"/",templateUrl:"partials/home.html",controller:"homeCtrl"}).state("report",{url:"/report",templateUrl:"partials/report.html",controller:"reportCtrl"}).state("report.media",{url:"/media",templateUrl:"partials/report.media.html"}).state("report.relationships",{url:"/relationships",templateUrl:"partials/report.relationships.html"}).state("report.grade",{url:"/grade",templateUrl:"partials/report.grade.html"}).state("report.analytics",{url:"/analytics",templateUrl:"partials/report.analytics.html"}).state("report.map",{url:"/map",templateUrl:"partials/report.map.html"}).state("demoReport",{url:"/demo/report",templateUrl:"demo/demoReport.html",controller:"demoReportCtrl",params:{reportId:null}}).state("demoReport.media",{url:"/media",templateUrl:"partials/report.media.html"}).state("demoReport.relationships",{url:"/relationships",templateUrl:"partials/report.relationships.html"}).state("demoReport.grade",{url:"/grade",templateUrl:"partials/report.grade.html"}).state("demoReport.analytics",{url:"/analytics",templateUrl:"partials/report.analytics.html"}).state("demoReport.map",{url:"/map",templateUrl:"partials/report.map.html"}).state("account",{url:"/account",templateUrl:"partials/account.html",controller:"accountCtrl",resolve:{user:["userService",function(e){return e.getAccount()}]}}).state("account.reports",{url:"/reports",templateUrl:"/partials/account.reports.html"}).state("account.stats",{url:"/stats",templateUrl:"/partials/account.stats.html"}).state("account.settings",{url:"/settings",templateUrl:"/partials/account.settings.html"}).state("account.relationships",{url:"/relationships",templateUrl:"/partials/account.relationships.html"}).state("demoAccount",{url:"/demo/account",templateUrl:"partials/demoAccount.html",controller:"demoAccountCtrl"}).state("demoAccount.reports",{url:"/reports",templateUrl:"/partials/account.reports.html"}).state("demoAccount.stats",{url:"/stats",templateUrl:"/partials/account.stats.html"}).state("demoAccount.settings",{url:"/settings",templateUrl:"/partials/account.settings.html"}).state("demoAccount.relationships",{url:"/relationships",templateUrl:"/partials/account.relationships.html"}).state("privacy",{url:"/privacy",templateUrl:"partials/privacy.html",controller:"basicCtrl"}).state("faq",{url:"/faq",templateUrl:"partials/faq.html",controller:"basicCtrl"}).state("contact",{url:"/contact",templateUrl:"partials/contact.html",controller:"basicCtrl"}),e.otherwise("/")}]).run(["$rootScope","$location","$window",function(e,t,o){e.$on("$stateChangeSuccess",function(e){o.ga&&o.ga("send","pageview",{page:t.path()})})}]),angular.module("myApp").directive("barChart",function(){return{link:function(e,t,o){$(function(){t.find("div.bar");var o=e.user.likesReceived,r=e.user.likesGiven;o>r?(t.find(".likes-received").css("width","100%"),t.find(".likes-given").css("width",r/o*100+"%")):o<r?(t.find(".likes-given").css("width","100%"),t.find(".likes-received").css("width",o/r*100+"%")):o===r&&t.find(".bar").css("width","100%"),$(t).hover(function(){$(this).popover("show")},function(){$(this).popover("hide")})})}}}),angular.module("myApp").directive("barChartExample",function(){return function(e,t,o){$(t).hover(function(){$(this).popover("show")},function(){$(this).popover("hide")})}}),angular.module("myApp").directive("tabBehavior",function(){return{restrict:"A",link:function(e,t,o){t.on("click",function(){t.siblings().removeClass("active"),t.addClass("active")})}}}),angular.module("myApp").directive("setUpTabs",["$location",function(e){return{scope:{tabs:"@"},link:function(t,o,r){$(function(){t.setUpTabs=function(){var r=JSON.parse(t.tabs),n=e.path(),a=$(o).find("li");a.removeClass("active");for(var i=0;i<r.length;i++){var s=r[i];n.indexOf(s)>-1&&$(a[i]).addClass("active")}},t.$on("$stateChangeSuccess",function(){t.setUpTabs()})})}}}]),angular.module("myApp").directive("wow",function(){return{link:function(e,t,o){$(function(){(new WOW).init()})}}}),angular.module("myApp").directive("userMenu",function(){return{link:function(e,t,o){$(function(){var e=$(t),o=e.find(".user-menu");e.removeClass("show-menu"),o.hide(),e.click(function(t){t.stopPropagation(),o.toggle(),e.toggleClass("show-menu")}),$("html").click(function(t){e.hasClass("show-menu")&&(e.removeClass("show-menu"),o.toggle())})})}}}),angular.module("myApp").directive("mainNavbar",["$interval",function(e){return{templateUrl:"partials/mainNavbar.html",link:function(t,o,r){$(function(){var t,r=$(o).find("div.main-nav"),n=0,a=5,i=r.outerHeight();$(window).scroll(function(e){t=!0}),e(function(){t&&(!function(){var e=$(this).scrollTop();if(Math.abs(n-e)<=a)return;e>n&&e>i?r.removeClass("nav-down").addClass("nav-up"):e+$(window).height()<$(document).height()&&r.removeClass("nav-up").addClass("nav-down");n=e}(),t=!1)},150)})}}}]),angular.module("myApp").directive("mainNavbarDemo",["$interval",function(e){return{templateUrl:"partials/mainNavbarDemo.html",link:function(t,o,r){$(function(){var t,r=$(o).find("div.main-nav"),n=0,a=5,i=r.outerHeight();$(window).scroll(function(e){t=!0}),e(function(){t&&(!function(){var e=$(this).scrollTop();if(Math.abs(n-e)<=a)return;e>n&&e>i?r.removeClass("nav-down").addClass("nav-up"):e+$(window).height()<$(document).height()&&r.removeClass("nav-up").addClass("nav-down");n=e}(),t=!1)},150)})}}}]),angular.module("myApp").directive("myFooter",function(){return{templateUrl:"partials/mainFooter.html",link:function(e,t,o){"full"===o.type?e.full=!0:"demo"===o.type?e.demo=!0:"less"===o.type?e.less=!0:"check"===o.type&&(!0===e.$parent.demo?e.demo=!0:!0===e.$parent.full&&(e.full=!0))}}}),angular.module("myApp").directive("logout",function(){return{link:function(e,t,o){$(t).click(function(){var e=document.createElement("script");e.src="https://instagram.com/accounts/logout",$("head").append(e)})}}}),angular.module("myApp").directive("searchbarExpand",function(){return{link:function(e,t,o){$(function(){var e=$(t),o=e.find("input.search-bar");o.focus(function(){e.animate({width:"330px"},200)}),o.blur(function(){e.css("width","270px")})})}}}),angular.module("myApp").directive("heartBehavior",["$interval","$timeout","$location","$state",function(e,t,o,r){return{link:function(o,n,a){$(function(){console.log(o.$parent),console.log(o);var a=$("div.instagram-crush-modal"),i=a.find(".modal-content"),s=(i.find("h4.match-title"),i.find("h6.match-subtitle")),l=i.find("img.user"),u=$(n),c=$("div.main-nav"),d=e(function(){"visible"!==u.css("visibility")||"report.relationships"!==r.current.name&&"demoReport.relationships"!==r.current.name||!function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(u)||o.$parent.$parent.hasPoppedUp?("report.relationships"!==r.current.name&&"demoReport.relationships"!==r.current.name&&e.cancel(d),o.$parent.$parent.hasPoppedUp&&(u.removeClass("invisible"),e.cancel(d))):(u.removeClass("invisible"),o.$parent.$parent.hasPoppedUp=!0,p(),u.addClass("pulse"),e.cancel(d))},200);function p(){a.modal("toggle"),c.hasClass("nav-down")?a.find(".modal-content").css("top","50px"):a.find(".modal-content").css("top","")}u.click(function(){p(),l.addClass("hidden"),s.addClass("hidden"),t(function(){s.removeClass("hidden")},200),t(function(){l.removeClass("hidden")},100),console.log(o.mostLikesReceived),console.log(o.$parent.$parent.$parent),o.rootUser=o.$parent.$parent.$parent})})}}}]),angular.module("myApp").directive("openDeleteAccountModal",function(){return{link:function(e,t,o){t.click(function(){console.log("blah");var e=$("div.main-nav");console.log(e);var t=$("#deleteAccountModal");t.modal("toggle"),e.hasClass("nav-down")?(console.log("down!!"),t.find(".modal-content").css("top","50px")):t.find(".modal-content").css("top","")})}}}),angular.module("myApp").directive("faqBehavior",function(){return{link:function(e,t,o){console.log("blah123");var r=$(t),n=(r.find("i.fa-caret-right"),r.find(".answer-container"));r.find(".answer-container").hide(),t.click(function(){$(this).hasClass("reveal")||($(".question-box").removeClass("reveal"),$(".question-box .answer-container").slideUp(),r.addClass("reveal"),n.slideDown(),console.log("blah"))})}}}),angular.module("myApp").directive("commentExpand",function(){return{link:function(e,t,o){var r=$(t),n=r.find("ul.comments"),a=r.find("span.comments-plus");a.on("click",function(){console.log("clicked! "),n.toggleClass("hidden"),a.toggleClass("active")})}}}),angular.module("myApp").directive("orderByControls",function(){return{link:function(e,t,o){var r='<i class="fa fa-caret-up"></i>',n={popularity:function(e,t){return 2*t.comments.count+t.likes.count-(2*e.comments.count+e.likes.count)},date:function(e,t){return t.created_time-e.created_time},type:function(e,t){return e.type>t.type?-1:e.type<t.type?1:0}};t.find("li.active").append(r),e.$parent.media&&e.$parent.media.sort(n.popularity),t.find("li").on("click",function(o){o.preventDefault();var a=$(this),i=a.attr("data-type"),s=n[i];a.hasClass("active")&&"random"!==a.attr("data-type")?(a.toggleClass("descending"),e.$parent.media.reverse(),e.$apply()):"random"===a.attr("data-type")?a.hasClass("active")?(a.toggleClass("descending"),e.$parent.media=_.shuffle(e.$parent.media),e.$apply()):(t.find("li.active").removeClass("active descending").find("i").remove(),a.addClass("active"),a.append('<i class="fa fa-refresh"></i>'),e.$parent.media=_.shuffle(e.$parent.media),e.$apply()):(t.find("li.active").removeClass("active descending").find("i").remove(),a.addClass("active"),a.append(r),e.$parent.media=e.$parent.media.sort(s),e.$apply())})}}}),angular.module("myApp").directive("equation",function(){return{scope:{numerator:"@",denominator:"@",result:"@"},templateUrl:"partials/equationDirective.html"}}),angular.module("myApp").directive("facebookShare",["$interval",function(e){return{link:function(t,o,r){$(function(){var n=e(function(){t.mostLikesReceived&&t.scores&&(e.cancel(n),function(){if(window.fbAsyncInit=function(){FB.init({appId:"918086384933928",status:!0,cookie:!0,xfbml:!0,version:"v2.3"})},i=document,s="facebook-jssdk",u=i.getElementsByTagName("script")[0],i.getElementById(s)||((l=i.createElement("script")).id=s,l.src="//connect.facebook.net/en_US/sdk.js",u.parentNode.insertBefore(l,u)),"grade"===r.type)var e="My Instagram scored a "+t.scores.overallScoreLetter+" on MediaScore.  What is your score??",n="",a="http://mediascore.rocks/img/mediascoreScore.png";var i,s,l,u;if("crush"===r.type)var e=t.mostLikesReceived.name+" is my Instagram Crush!  Who is Yours??",n=t.mostLikesReceived.name+" has liked "+t.mostLikesReceived.likesReceived+" of my "+t.user.numMedia+" pieces of media! ("+Math.round(100*Number(t.mostLikesReceived.likesReceived)/Number(t.user.numMedia)).toString()+"%).",a="http://mediascore.rocks/img/mediascore.png";o.click(function(){FB.ui({method:"feed",href:"http://mediascore.rocks",link:"http://mediascore.rocks",picture:a,name:e,description:n},function(e){console.log(e)})})}())},200)})}}}]),angular.module("myApp").directive("googleMap",["$filter","$interval",function(e,t){return{link:function(o,r,n){var a=t(function(){var r,n,i,s;o.report&&(t.cancel(a),n=o.report.map.allLocations,i=n[n.length-1],s={lat:i.latitude,lng:i.longitude},window.initMap=function(){r=new google.maps.Map(document.getElementById("map"),{center:s,zoom:8});for(var t=new google.maps.InfoWindow({content:"holding..."}),o=0;o<n.length;o++){var a=n[o],i=e("date")(1e3*a.date,"EEEE, MMMM d, yyyy"),l='<div class="info-window"><img class="location-pic" src="'+a.pic.url+'"><p class="date">'+i+'</p><p class="name">'+a.name+"</p></div>",u=new google.maps.Marker({position:{lat:a.latitude,lng:a.longitude},title:a.name,html:l});u.addListener("click",function(){t.setContent(this.html),t.open(r,this)}),u.setMap(r)}})})}}}]),angular.module("myApp").directive("gradeDirective",function(){return{link:function(e,t,o){$(function(){var e=$(t).find("span.show-explanation"),o=$(t).find(".grade-explanation");o.hide(),e.removeClass("reveal"),e.click(function(){$(this).toggleClass("reveal"),o.slideToggle(200)})})}}}),angular.module("myApp").directive("scoreBar",["$interval",function(e){return{link:function(t,o,r){$(function(){var n=e(function(){t.scores&&(!function(){var e=r.category,n=t.scores[e];o.css("width",n+"%");var a=gradeColor(n);o.css("background",a)}(),e.cancel(n))},50)})}}}]),angular.module("myApp").directive("hashtagBarChart",function(){return{link:function(e,t,o){$(function(){var o=e.report.analytics.tagsGroupsNames,r=e.report.analytics.tagsGroupsCounts;e.report.analytics.currentTags=o[0],e.report.analytics.currentTagsCounts=r[0];var n={chart:{type:"column",style:{fontFamily:"'Playfair Display', serif"},backgroundColor:"#fafafa"},credits:{enabled:!1},title:{text:null},subtitle:{text:null},xAxis:{categories:e.report.analytics.currentTags,crosshair:!0,labels:{style:{fontSize:"15px"}}},yAxis:{labels:{style:{fontSize:"15px"}},min:0,title:{text:"Count",style:{fontSize:"15px"}}},plotOptions:{column:{color:"#458eff",pointPadding:.2,borderWidth:0}},series:[{name:"Number of hashtag uses",data:e.report.analytics.currentTagsCounts}]};$(t).highcharts(n);var a=$(t).highcharts(),i=$(t).parent().find("i.cycle-left");$(t).parent().find("i.cycle-right").on("click",function(t){t.preventDefault(),e.index++;var i=o[e.index],s=r[e.index];e.report.analytics.currentTags=i,e.report.analytics.currentTagsCounts=s,a.destroy(),n.xAxis.categories=i,n.series[0].data=s,a=new Highcharts.Chart(n),e.noMoreLeft=!1,e.$apply(),r[e.index+1]||(e.noMoreRight=!0,e.$apply())}),i.on("click",function(t){t.preventDefault(),e.index--;var i=o[e.index],s=r[e.index];e.report.analytics.currentTags=i,e.report.analytics.currentTagsCounts=s,a.destroy(),n.xAxis.categories=i,n.series[0].data=s,a=new Highcharts.Chart(n),e.noMoreRight=!1,e.$apply(),r[e.index-1]||(e.noMoreLeft=!0,e.$apply())})})}}}),angular.module("myApp").directive("hashtagScatter",["$interval",function(e){return{link:function(t,o,r){$(function(){t.report.analytics.hashtagScatter;var r={chart:{type:"scatter",zoomType:"xy",style:{fontFamily:"'Playfair Display', serif"},backgroundColor:"#fafafa"},credits:{enabled:!1},title:{text:null},subtitle:{text:null},xAxis:{title:{enabled:!0,text:"Number of Hashtags vs. Number of Interactions"},startOnTick:!0,endOnTick:!0,showLastLabel:!0},yAxis:{labels:{style:{fontSize:"15px"}},title:{text:"Number of Interactions ",style:{fontSize:"15px"}}},plotOptions:{scatter:{color:"#458eff",marker:{radius:5,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x} hashtags, {point.y} interactions"}}},series:[{name:"Number of hashtag uses",data:t.report.analytics.hashtagScatter}]},n=e(function(){"visible"===$(o).parent().css("visibility")&&($(o).highcharts(r),e.cancel(n))},200)})}}}]),angular.module("myApp").directive("statsGraph",["$interval",function(e){return{link:function(t,o,r){$(function(){Highcharts.setOptions({global:{useUTC:!1},lang:{thousandsSep:","}}),t.categories={numFollowers:{title:"Number of Followers",yAxis:"Number of Followers",tooltip:"Followers",numberFormat:".0f"},numFollows:{title:"Number of Follows",yAxis:"Number of Follows",tooltip:"Follows",numberFormat:".0f"},numMedia:{title:"Number of Media",yAxis:"Number of Media",tooltip:"Media",numberFormat:".0f"},numLikesGiven:{title:"Number of Likes Given",yAxis:"Number of Likes",tooltip:"# Likes Given",numberFormat:".0f"},numLikesReceived:{title:"Number of Likes Received",yAxis:"Number of Likes",tooltip:"# Likes Received",numberFormat:".0f"},userRatio:{title:"User Ratio",yAxis:"User Ratio",tooltip:"User Ratio",numberFormat:".2f"},adjustedAverageNumLikes:{title:"Adjusted Average Number of Likes",yAxis:"Adjusted Average # of Likes",tooltip:"AAL",numberFormat:".2f"}},t.labels=[{title:"Number of Followers",ref:"numFollowers"},{title:"Number of Follows",ref:"numFollows"},{title:"Number of Media",ref:"numMedia"},{title:"Number of Likes Given",ref:"numLikesGiven"},{title:"Number of Likes Received",ref:"numLikesReceived"},{title:"User Ratio",ref:"userRatio"},{title:"Adjusted Average Number of Likes",ref:"adjustedAverageNumLikes"}],t.updateChart=function(e){console.log(e),t.category=e,t.currentData=t.stats.map(function(e,o,r){return[Date.parse(e[0]),e[1][t.category]]}),$(o).highcharts(function(){t.categories[t.category].yAxis;var e=t.categories[t.category].numberFormat;return t.categories[t.category].tooltip,{chart:{zoomType:"x",style:{fontFamily:"'Playfair Display', serif"},backgroundColor:"#fafafa"},credits:{enabled:!1},title:{text:""},subtitle:{text:void 0===document.ontouchstart?"Click and drag in the plot area to zoom in":"Pinch the chart to zoom in",style:{fontSize:"12px",fontStyle:"italic",color:"#b0b0b0"}},xAxis:{type:"datetime",labels:{style:{fontSize:"12px"}},dateTimeLabelFormats:{month:"%b-- %e",year:"%b"}},yAxis:{title:{text:t.categories[t.category].yAxis,style:{fontSize:"15px"}},labels:{style:{fontSize:"13px"},format:"{value:,"+e+"}"}},tooltip:{headerFormat:"<b>{point.x:%b %e,  %Y}</b><br>",pointFormat:t.categories[t.category].tooltip+": {point.y:,"+e+"}"},legend:{enabled:!1},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#599CFF"],[1,"#458eff"]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[{type:"area",data:t.currentData}]}}())};var r=e(function(){t.stats&&(t.updateChart("numLikesGiven"),e.cancel(r))},50)})}}}]),angular.module("myApp").directive("timeBar",["$interval",function(e){return{link:function(t,o,r){$(function(){var r={chart:{type:"column",style:{fontFamily:"'Playfair Display', serif"},backgroundColor:"#fafafa"},credits:{enabled:!1},title:{text:null},subtitle:{text:null},xAxis:{categories:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],crosshair:!0,labels:{style:{fontSize:"15px"}}},yAxis:{labels:{style:{fontSize:"15px"}},min:0,title:{text:"Number of Media",style:{fontSize:"15px"}}},plotOptions:{column:{color:"#458eff",pointPadding:.2,borderWidth:0}},series:[{name:"Number of Media",data:t.report.analytics.daysOfWeekArr}]},n=e(function(){"visible"===$(o).parent().css("visibility")&&($(o).highcharts(r),e.cancel(n))},200)})}}}]),angular.module("myApp").directive("twitterShare",["$interval",function(e){return{link:function(t,o,r){console.log("scope for twitteer is",t);var n=e(function(){t.scores&&t.mostLikesReceived&&(e.cancel(n),function(){if("grade"===r.type)var o="My Instagram scored a "+t.scores.overallScoreLetter+" on MediaScore.  What is your score?? Find out at: ";if("crush"===r.type)var o=t.mostLikesReceived.name+" is my Instagram Crush!  Who is yours?  Find out at:";var n=document.createElement("a");n.setAttribute("href","https://twitter.com/share"),n.setAttribute("class","twitter-share-button"),n.setAttribute("style","margin-top:5px;"),n.setAttribute("id","twitterbutton"),n.setAttribute("data-text",""+o),n.setAttribute("data-url","http://mediascore.rocks"),n.setAttribute("data-size","large"),tweetdiv=document.getElementById("twtbox"),tweetdiv.appendChild(n);var a=e(function(){twttr?twttr.widgets?(e.cancel(a),twttr.widgets.load()):console.log("widgets not loaded"):console.log("twttrnot loaded")},200)}())},200)}}}]),analyzeFunc.$inject=["$filter"],angular.module("myApp").service("analyzeService",analyzeFunc),demoServiceFunc.$inject=["$http"],angular.module("myApp").service("demoService",demoServiceFunc),followFunc.$inject=["$http","$q"],angular.module("myApp").service("followService",followFunc),instaFunc.$inject=["$http","$q","analyzeService"],angular.module("myApp").service("instaService",instaFunc),angular.module("myApp").service("reportService",["$http",function(e){this.getToken=function(){return e.get("/api/token").then(function(e){return console.log(e),e})},this.addReport=function(t){console.log("add report!"),e.post("/api/reports",t)},this.getLatestReportDate=function(){return e.get("/api/reports/latestDate").then(function(e){var t=e.data;return Date.parse(t)})},this.getStats=function(){return e.get("/api/reports/stats").then(function(e){return e.data})},this.getRelationships=function(t){return e.get("/api/getRelationships?userId="+t).then(function(e){return e.data})}}]),userFunc.$inject=["$http","$q"],angular.module("myApp").service("userService",userFunc),profileFunc.$inject=["$scope","user","reportService","userService","$state","$interval","$filter"],angular.module("myApp").controller("accountCtrl",profileFunc),basicCtrlFunc.$inject=["$scope","userService"],angular.module("myApp").controller("basicCtrl",basicCtrlFunc),profileFuncDemo.$inject=["$scope","demoService","reportService","userService","$state","$interval","$filter"],angular.module("myApp").controller("demoAccountCtrl",profileFuncDemo),demoReportCtrlFunc.$inject=["$scope","demoService","reportService","userService","instaService","followService","$sce","$filter","$http","$stateParams"],angular.module("myApp").controller("demoReportCtrl",demoReportCtrlFunc),ctrlFunc.$inject=["$scope","instaService","$state","reportService"],angular.module("myApp").controller("homeCtrl",ctrlFunc),angular.module("myApp").controller("reportCtrl",["$scope","reportService","userService","instaService","followService","$sce","$filter","$http",function(e,t,o,r,n,a,i,s){function l(e){for(var t=0;t<e.length;t++){var o=e[t];"video"===o.type&&(o.safeurl=a.trustAsResourceUrl(o.videos.standard_resolution.url))}}console.log("results controller loaded!"),window.scroll(0,0),e.loadingUser=!0,e.loadingMedia=!0,e.loadingEverythingElse=!0,t.getToken().then(function(n){if(console.log("results controller getting response!"),console.log(n.data),n.data.analytics){console.log("user already exists!!!"),o.toggleSpecificReport(null);var a=n.data;e.report=a,(i=n.data.user).newUser=!1,u(null,i)}else if(n.data.numMedia){console.log("new user, need to do lots of api calls!");var i=n.data,s=n.data.token;i.newUser=!0,u(s,i)}function u(n,i){n=n,i=i;e.token=n;var s=i.numMedia,u=i.numFollows,d=i.numFollowers;e.user=i,e.loadingUser=!1;var p,m,f,h,g={fast:"You have "+s+" pieces of media.  This should only take a few moments",medium:"You have "+s+" pieces of media.  This shouldn't take too long",slow:"Wow!  You have "+s+" pieces of media.  We're taking care of this as fast as we can, but this might take a minute or two"},v={fast:"You have "+d+" followers and follow "+u+" users.  This should only take 2-3 minutes",medium:"You have "+d+" followers and follow "+u+" users.  This shouldn't take too long, please check back in 10 minutes or so.",slow:"Wow!  You have "+d+" followers and follow "+u+" users.  We're taking care of this as fast as we can, but this might take 20 minutes or so."};s<100?e.loadingMediaMessage=g.fast:s>100&&s<300?e.loadingMediaMessage=g.medium:s>300&&(e.loadingMediaMessage=g.slow),d<=200&&u<=200?e.otherLoadingMessage=v.fast:d>=1e3||u>=1e3?e.otherLoadingMessage=v.slow:(d<1e3||u<1e3)&&(e.otherLoadingMessage=v.medium),p=n,(m=i).newUser?(console.log("user is new"),f=p,h=m,r.getMedia(f,h).then(function(n){var a,i;console.log("REPORT RECEIVED OF JUST MEDIA IS \n\n",n),l(n.media),e.media=n.media.sort(function(e,t){return 2*t.comments.count+t.likes.count-(2*e.comments.count+e.likes.count)}),e.loadingMedia=!1,a=f,i=n,r.getOtherData(a,i).then(function(r){console.log("FINAL REPORT RECEIVED IS \n\n",r),e.report=r,o.addUser(r.user).then(function(e){console.log("about to add report!!!"),console.log("this is step that is not working");var n=r.media.map(function(e){var t={attribution:e.attribution,caption:e.caption,comments:e.comments,created_time:e.created_time,filter:e.filter,id:e.id,images:e.images,likes:{count:e.likes.count},link:e.link,location:e.location,tags:e.tags,type:e.type,user_has_liked:e.user_has_liked,users_in_photo:e.users_in_photo};return"video"===e.type&&(t.videos=e.videos),t}),a={user:r.user,grade:r.grade,analytics:{numLikesGiven:r.analytics.numLikesGiven,numLikesReceived:r.analytics.numLikesReceived,numPics:r.analytics.numPics,numVids:r.analytics.numVids,averageNumLikes:r.analytics.averageNumLikes,numSelfLikes:r.analytics.numSelfLikes,hashtagScatter:r.analytics.hashtagScatter,allTimes:r.analytics.allTimes,allTagsArr:r.analytics.allTagsArr,daysOfWeek:r.analytics.daysOfWeek,daysOfWeekArr:r.analytics.daysOfWeekArr},map:r.map,media:n,relationships:{followers:r.relationships.followers,follows:r.relationships.follows,likesComparisonArr:r.relationships.likesComparisonArr,uniqueFollowers:r.relationships.uniqueFollowers,uniqueFollows:r.relationships.uniqueFollows}};t.addReport(a),o.toggleReadyForReport(!1),o.toggleSpecificReport(null),c(r)})})})):(console.log("user is not new"),console.log(a),l(a.media),e.media=a.media.sort(function(e,t){return 2*t.comments.count+t.likes.count-(2*e.comments.count+e.likes.count)}),e.loadingMedia=!1,c(a))}});var u={uniqueFollows:0,uniqueFollowers:0,userLikersArr:0,yourLikesUsersArr:0,likesComparisonArr:0};function c(t){e.clone={uniqueFollows:e.report.relationships.uniqueFollows.slice(0),uniqueFollowers:e.report.relationships.uniqueFollowers.slice(0),likesComparisonArr:e.report.relationships.likesComparisonArr.slice(0)};for(var o=e.report.relationships.likesComparisonArr,r=0;r<o.length;r++){var n=o[r];if(n.mostLikesReceived){e.mostLikesReceived=n;break}}var a=e.report.analytics.allTagsArr,s=[],l=[],u=-1;for(r=0;r<a.length&&a[r];r++){var c=a[r].hashtag,d=a[r].count;r%12==0?(u++,s.push([c]),l.push([d])):(s[u].push(c),l[u].push(d))}e.noMoreLeft=!0,e.noMoreRight=!1,e.index=0;var p=s[0],m=l[0];e.report.analytics.currentTags=p,e.report.analytics.currentTagsCounts=m,e.report.analytics.tagsGroupsNames=s,e.report.analytics.tagsGroupsCounts=l;var f=i("number")(100*t.grade.selfLikesRatio,1),h=t.grade.selfLikesRatio;0===h&&(e.likesRatioMessage="Wow, you haven't liked a single one of your photos!  Thank you for "),h<.2?e.likesRatioMessage="Congrats, you must not be very self-centered!  You have only liked "+t.grade.numSelfLikes+" ("+f+"%) of your media.  ":h<.5&&(e.likesRatioMessage="Okay, you've liked "+t.grade.numSelfLikes+" ("+f+"%) of your media.  Not too high, but try to be a little "),e.scores=t.grade.scores,console.log("scores is \n\n"),console.log(e.scores);var g=function(e){if((e=Math.round(e))<60)return"F";if(e>99)return"A+";var t,o=Number(e.toString()[0]),r=[6,7,8,9].indexOf(o);e%10<10&&(t="+");e%10<7&&(t="");e%10<3&&(t="-");return["D","C","B","A"][r]+t}(e.scores.overallScore);e.scores.overallScoreLetter=g,e.loadMore("uniqueFollows"),e.loadMore("uniqueFollowers"),e.loadMore("likesComparisonArr"),e.loadingEverythingElse=!1}e.noMore={uniqueFollows:!1,uniqueFollowers:!1,userLikersArr:!1,yourLikesUsersArr:!1,likesComparisonArr:!1},e.uniqueFollows=[],e.uniqueFollowers=[],e.userLikersArr=[],e.yourLikesUsersArr=[],e.likesComparisonArr=[],e.loadMore=function(t){u[t]++;for(var o=u[t],r=0;r<12*o;r++){var n=e.clone[t].pop();if(!n)return void(e.noMore[t]=!0);e[t].push(n)}},e.unfollowUser=function(t){n.unfollowUser(t,e.token)},e.followUser=function(e){n.followUser(e)},e.closeExample=function(){$("div.example").slideToggle(400)}}]),angular.module("myApp").controller("tokenCtrl",["$scope","$stateParams","$state","tokenService",function(e,t,o,r){var n=t.token;r.setToken(n),o.go("results.media")}]),angular.module("myApp").filter("duration",function(){return function(e){var t=Math.floor(e/1e3),o=Math.floor(t/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60);return n<10&&(n="0"+n),o<10&&(o="0"+o),r<10&&(r="0"+r),o+":"+r+" :"+n}});